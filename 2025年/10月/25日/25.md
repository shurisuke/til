# TIL：nil 対応と build_body の改善

1. nil に対する防御的プログラミング
	•	article_block.blockable.body が nil のときにエラーを防ぐため、next if sentence.body.nil? というガード節を用いる方法を学びました。
	•	Ruby では、nil に対してメソッドを呼ぶと NoMethodError になるため、事前に nil チェックを行うことが重要。

2. ActiveDecorator の活用
	•	表示用の整形処理（デコレーション）をモデル本体から分離することで、medium.media_type や embed.embed_type などのロジックをスッキリ記述できる。
	•	ActiveDecorator::Decorator.instance.decorate(...) を使うことで、任意のオブジェクトをデコレーターでラップして使用可能に。

3. render_to_string の用途
	•	controller.render_to_string(...) により、ビューの HTML を文字列として取得可能。
	•	プレビュー表示など、画面描画せず HTML を生成したいケースに適している。